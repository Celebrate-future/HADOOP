{"paragraphs":[{"text":"%md\n\n# Movielens Zeppelin Hive Dashboard\n","dateUpdated":"2018-10-11T10:30:58+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Movielens Zeppelin Hive Dashboard</h1>\n"}]},"apps":[],"jobName":"paragraph_1539252925450_-1970331114","id":"20181010-150009_1134051150","dateCreated":"2018-10-11T10:15:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:185","user":"anonymous","dateFinished":"2018-10-11T10:30:58+0000","dateStarted":"2018-10-11T10:30:58+0000"},{"text":"%jdbc(hive)\nCREATE database if not exists movielens;\nshow databases;","dateUpdated":"2018-10-11T10:30:58+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{"1":{"graph":{"mode":"table","height":154,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"database_name\ndefault\nmovielens\n"}]},"apps":[],"jobName":"paragraph_1539252925457_-1962251387","id":"20181010-150410_1628559872","dateCreated":"2018-10-11T10:15:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:186","user":"anonymous","dateFinished":"2018-10-11T10:30:59+0000","dateStarted":"2018-10-11T10:30:58+0000"},{"text":"%jdbc(hive)\nuse movielens;\n\n-- drop table if exists movies;\n\nCREATE EXTERNAL TABLE IF NOT EXISTS movies (\nMovieID STRING,\nTitle STRING,\nGenres STRING)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '@'\nLOCATION '/dane/movielens/ml-20m-hive/movies';\n\n\n-- drop table if exists ratings;\n\nCREATE EXTERNAL TABLE IF NOT EXISTS ratings (\nUserID STRING,\nMovieID STRING,\nRating STRING,\nTime STRING)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '@'\nLOCATION '/dane/movielens/ml-20m-hive/ratings';\n\n\n-- drop table if exists tags;\n\nCREATE EXTERNAL TABLE IF NOT EXISTS tags (\nUserID STRING,\nMovieID STRING,\nTag STRING,\nTime STRING)\nROW FORMAT DELIMITED FIELDS TERMINATED BY '@'\nLOCATION '/dane/movielens/ml-20m-hive/tags';\n\nshow tables;","dateUpdated":"2018-10-11T10:30:58+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"tab_name\nemovies\neratings\netags\nmovies\nratings\ntags\n"}]},"apps":[],"jobName":"paragraph_1539252925457_-1962251387","id":"20181010-150121_1920083710","dateCreated":"2018-10-11T10:15:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:187","user":"anonymous","dateFinished":"2018-10-11T10:31:00+0000","dateStarted":"2018-10-11T10:30:58+0000"},{"text":"%jdbc(hive)\nuse movielens;\n\nselect * from movies limit 10;","dateUpdated":"2018-10-11T10:30:58+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"movies.movieid\tmovies.title\tmovies.genres\n1\tToy Story (1995)\tAdventure|Animation|Children|Comedy|Fantasy\n2\tJumanji (1995)\tAdventure|Children|Fantasy\n3\tGrumpier Old Men (1995)\tComedy|Romance\n4\tWaiting to Exhale (1995)\tComedy|Drama|Romance\n5\tFather of the Bride Part II (1995)\tComedy\n6\tHeat (1995)\tAction|Crime|Thriller\n7\tSabrina (1995)\tComedy|Romance\n8\tTom and Huck (1995)\tAdventure|Children\n9\tSudden Death (1995)\tAction\n10\tGoldenEye (1995)\tAction|Adventure|Thriller\n"}]},"apps":[],"jobName":"paragraph_1539252925458_-1961097140","id":"20181010-144845_1980610290","dateCreated":"2018-10-11T10:15:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:188","user":"anonymous","dateFinished":"2018-10-11T10:30:59+0000","dateStarted":"2018-10-11T10:30:58+0000","title":"Filmy"},{"dateUpdated":"2018-10-11T10:30:58+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539252925459_-1961481889","id":"20181010-153403_633140318","dateCreated":"2018-10-11T10:15:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:189","user":"anonymous","dateFinished":"2018-10-11T10:31:29+0000","dateStarted":"2018-10-11T10:30:59+0000","title":"TOP 10 filmów wszech czasów","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"m.title\trate\tvotes\nShawshank Redemption, The (1994)\t4.446990499637029\t63366\nGodfather, The (1972)\t4.364732196832306\t41355\nUsual Suspects, The (1995)\t4.334372207803259\t47006\nSchindler's List (1993)\t4.310175010988133\t50054\nGodfather: Part II, The (1974)\t4.275640557704942\t27398\nSeven Samurai (Shichinin no samurai) (1954)\t4.2741796572216\t11611\nRear Window (1954)\t4.271333600779414\t17449\nBand of Brothers (2001)\t4.263182346109176\t4305\nCasablanca (1942)\t4.258326830670664\t24349\nSunset Blvd. (a.k.a. Sunset Boulevard) (1950)\t4.256934865900383\t6525\n"}]},"text":"%jdbc(hive)\nuse movielens;\n\nselect m.title, avg(r.rating) rate, count(1) votes\nfrom movies m\njoin ratings r on m.movieid = r.movieid\ngroup by m.title\nhaving votes > 100\norder by rate desc limit 10 ;\n"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{"1":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"editOnDblClick":false,"language":"sql"},"editorMode":"ace/mode/sql","tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539253250708_-119274628","id":"20181011-102050_1593980146","dateCreated":"2018-10-11T10:20:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1871","text":"%jdbc(hive)\nuse movielens;\n\nselect substring(title, -5, 4) year, count(*) ile\nfrom movies\ngroup by substring(title, -5, 4)\norder by ile desc;\n","dateUpdated":"2018-10-11T10:30:58+0000","dateFinished":"2018-10-11T10:31:21+0000","dateStarted":"2018-10-11T10:30:59+0000","title":"Rozkład filmów w latach (według daty produkcji)","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"year\tile\n2009\t1105\n2013\t997\n2012\t997\n2011\t991\n2008\t971\n2010\t942\n2007\t893\n2006\t848\n2014\t737\n2005\t733\n2004\t703\n2002\t675\n2003\t652\n2001\t630\n2000\t613\n1998\t552\n1999\t537\n1997\t527\n1996\t509\n1995\t469\n1994\t431\n1993\t369\n1992\t335\n1988\t322\n1991\t312\n1990\t312\n1987\t312\n1989\t309\n1986\t262\n1985\t253\n1981\t248\n1980\t241\n1982\t238\n1984\t233\n1983\t221\n1972\t218\n1973\t209\n1971\t203\n1979\t202\n1968\t201\n1970\t200\n1966\t199\n1977\t197\n1976\t196\n1975\t196\n1974\t195\n1978\t191\n1969\t177\n1964\t173\n1967\t172\n1965\t163\n1957\t162\n1959\t151\n1962\t150\n1960\t148\n1963\t147\n1955\t146\n1958\t143\n1953\t136\n1956\t135\n1952\t131\n1951\t125\n1949\t125\n1961\t122\n1950\t121\n2015\t120\n1940\t117\n1943\t117\n1954\t113\n1941\t107\n1936\t107\n1935\t107\n1945\t105\n1937\t103\n1942\t101\n1944\t101\n1948\t101\n1934\t101\n1947\t99\n1933\t98\n1932\t96\n1938\t94\n1939\t93\n1946\t92\n1931\t69\n1930\t59\n1929\t49\n1928\t47\n1926\t40\n1925\t32\n1927\t31\n1924\t30\n1921\t27\n011)\t25\n012)\t25\n1922\t25\n010)\t20\n1920\t19\n1923\t17\n1919\t17\n1916\t17\n1915\t17\n013)\t14\n1914\t13\n1917\t12\n008)\t8\n009)\t8\n1918\t8\n007)\t8\n005)\t8\n006)\t7\n1913\t5\n1898\t5\n999)\t5\n995)\t5\n1912\t5\n986)\t4\n970)\t4\n002)\t3\n1910\t3\n958)\t3\n014)\t3\n004)\t3\n001)\t3\n976)\t3\n998)\t3\n988)\t3\n965)\t3\n968)\t2\n1909\t2\n983)\t2\n980)\t2\n971)\t2\n973)\t2\n1896\t2\n1895\t2\n1894\t2\n003)\t2\n993)\t2\n990)\t2\n\t1\n Ala\t1\n Fal\t1\n Nyr\t1\n Roa\t1\n007-\t1\n09– \t1\n1891\t1\n1893\t1\n1899\t1\n1900\t1\n1901\t1\n1902\t1\n1903\t1\n1905\t1\n909)\t1\n928)\t1\n929)\t1\n937)\t1\n938)\t1\n948)\t1\n949)\t1\n950)\t1\n956)\t1\n957)\t1\n961)\t1\n962)\t1\n963)\t1\n967)\t1\n972)\t1\n977)\t1\n978)\t1\n984)\t1\n985)\t1\n987)\t1\n989)\t1\n994)\t1\n997)\t1\nCial\t1\nWorl\t1\nYoun\t1\nadge\t1\narde\t1\nbore\t1\ndium\t1\ngówn\t1\nille\t1\ninso\t1\nlon \t1\nn Ma\t1\nnqui\t1\npiel\t1\npoma\t1\nstei\t1\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{"1":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"counted","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"editOnDblClick":false,"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539253355755_-1392623277","id":"20181011-102235_1387752112","dateCreated":"2018-10-11T10:22:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2025","text":"%jdbc(hive)\nuse movielens;\n\nselect q.genre as genre, count(1) as counted\nfrom (select explode(split(genres,\"\\\\|\")) AS genre from movies) q\ngroup by genre\norder by counted desc;\n","dateUpdated":"2018-10-11T10:30:58+0000","dateFinished":"2018-10-11T10:31:33+0000","dateStarted":"2018-10-11T10:30:59+0000","title":"Liczba filmów według gatunku","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"genre\tcounted\nDrama\t13344\nComedy\t8374\nThriller\t4177\nRomance\t4127\nAction\t3520\nCrime\t2939\nHorror\t2611\nDocumentary\t2470\nAdventure\t2329\nSci-Fi\t1743\nMystery\t1514\nFantasy\t1412\nWar\t1194\nChildren\t1139\nMusical\t1035\nAnimation\t1027\nWestern\t676\nFilm-Noir\t330\n(no genres listed)\t246\nIMAX\t196\nHeart) (2007)\t1\nme (2003)\t1\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{"1":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"editOnDblClick":false,"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539253409986_-1460076928","id":"20181011-102329_1687831681","dateCreated":"2018-10-11T10:23:29+0000","status":"RUNNING","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2187","text":"%jdbc(hive)\nuse movielens;\n\nselect year(from_unixtime(cast(time as bigint))) as year, count(*) as ile\nfrom ratings\ngroup by year(from_unixtime(cast(time as bigint)))\norder by year\nlimit 10;\n","dateUpdated":"2018-10-11T10:30:58+0000","dateFinished":"2018-10-11T10:30:44+0000","dateStarted":"2018-10-11T10:31:00+0000","errorMessage":"","title":"Oceny w latach"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{"1":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539253536702_-973202648","id":"20181011-102536_562122210","dateCreated":"2018-10-11T10:25:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2608","text":"%jdbc(hive)\nuse movielens;\n\nselect year(from_unixtime(cast(time as bigint))) as year, count(*) as ile\nfrom tags\ngroup by year(from_unixtime(cast(time as bigint)))\norder by year\nlimit 10;\n","dateUpdated":"2018-10-11T10:31:00+0000","dateFinished":"2018-10-11T10:31:36+0000","dateStarted":"2018-10-11T10:31:00+0000","title":"Tagi w latach","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"year\tile\nnull\t3\n1970\t2\n2005\t29\n2006\t34129\n2007\t31345\n2008\t20321\n2009\t68981\n2010\t57428\n2011\t65341\n2012\t55375\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539253568571_-645350612","id":"20181011-102608_406183225","dateCreated":"2018-10-11T10:26:08+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2715"}],"name":"Movielens","id":"2DUQGE931","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}