{"paragraphs":[{"text":"%md\n\n# Movielens Zeppelin Hive Dashboard\n","user":"admin","dateUpdated":"2018-11-23T23:59:11+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true,"title":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543016588769_-2060984212","id":"20181010-150009_1134051150","dateCreated":"2018-11-23T23:43:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10286","dateFinished":"2018-11-23T23:57:34+0000","dateStarted":"2018-11-23T23:57:31+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Movielens Zeppelin Hive Dashboard</h1>\n"}]}},{"text":"%jdbc(hive)\nuse radek;\nshow tables;","user":"admin","dateUpdated":"2018-11-24T00:00:08+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false,"tableHide":false,"lineNumbers":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543016588773_1676722436","id":"20181026-215942_1831362378","dateCreated":"2018-11-23T23:43:08+0000","dateStarted":"2018-11-23T23:57:34+0000","dateFinished":"2018-11-23T23:57:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10287","title":"Tabele w bazie użytkownika","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"tab_name\nmovies\nradek\nratings\nratings_bucket\nratings_part\ntags\n"}]}},{"title":"Filmy","text":"%jdbc(hive)\nuse radek;\n\nselect * from movies limit 10;","user":"admin","dateUpdated":"2018-11-23T23:59:55+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movies.movieid":"string","movies.title":"string","movies.genres":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543016588773_124059376","id":"20181010-144845_1980610290","dateCreated":"2018-11-23T23:43:08+0000","dateStarted":"2018-11-23T23:57:34+0000","dateFinished":"2018-11-23T23:57:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10288","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"movies.movieid\tmovies.title\tmovies.genres\n1\tToy Story (1995)\tAdventure|Animation|Children|Comedy|Fantasy\n2\tJumanji (1995)\tAdventure|Children|Fantasy\n3\tGrumpier Old Men (1995)\tComedy|Romance\n4\tWaiting to Exhale (1995)\tComedy|Drama|Romance\n5\tFather of the Bride Part II (1995)\tComedy\n6\tHeat (1995)\tAction|Crime|Thriller\n7\tSabrina (1995)\tComedy|Romance\n8\tTom and Huck (1995)\tAdventure|Children\n9\tSudden Death (1995)\tAction\n10\tGoldenEye (1995)\tAction|Adventure|Thriller\n"}]}},{"title":"TOP 10 filmów wszech czasów","text":"%jdbc(hive)\nuse radek;\n\nselect m.title, avg(r.rating) rate, count(1) votes\nfrom movies m\njoin ratings r on m.movieid = r.movieid\ngroup by m.title\nhaving votes > 100\norder by rate desc limit 10 ;\n","user":"admin","dateUpdated":"2018-11-23T23:58:47+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"m.title":"string","rate":"string","votes":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543016588774_1623946254","id":"20181010-153403_633140318","dateCreated":"2018-11-23T23:43:08+0000","dateStarted":"2018-11-23T23:57:34+0000","dateFinished":"2018-11-23T23:57:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10289","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"m.title\trate\tvotes\nShawshank Redemption, The (1994)\t4.457238321660348\t31126\nGodfather, The (1972)\t4.415085293227011\t19814\nUsual Suspects, The (1995)\t4.367142322253193\t24037\nSchindler's List (1993)\t4.363482949916592\t25777\nSunset Blvd. (a.k.a. Sunset Boulevard) (1950)\t4.321966205837174\t3255\nCasablanca (1942)\t4.319740945070761\t12507\nRear Window (1954)\t4.316543909348442\t8825\nDouble Indemnity (1944)\t4.315439034540158\t2403\nSeven Samurai (Shichinin no samurai) (1954)\t4.314119283602851\t5751\nThird Man, The (1949)\t4.313629402756509\t3265\n"}]}},{"title":"Rozkład filmów w latach (według daty produkcji)","text":"%jdbc(hive)\nuse radek;\n\nselect substring(title, -5, 4) year, count(*) ile\nfrom movies\ngroup by substring(title, -5, 4)\norder by ile desc;\n","user":"admin","dateUpdated":"2018-11-23T23:58:47+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"1":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"year","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"ile","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543016588774_1988096707","id":"20181011-102050_1593980146","dateCreated":"2018-11-23T23:43:08+0000","dateStarted":"2018-11-23T23:57:49+0000","dateFinished":"2018-11-23T23:57:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10290","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"year\tile\n2002\t441\n2000\t405\n2001\t403\n1996\t384\n1998\t384\n1997\t370\n2003\t366\n2007\t364\n1995\t362\n1999\t357\n2006\t345\n2004\t342\n2005\t332\n1994\t307\n1993\t258\n2008\t251\n1988\t214\n1989\t212\n1992\t212\n1987\t205\n1990\t200\n1991\t188\n1981\t178\n1982\t170\n1986\t166\n1980\t161\n1985\t158\n1984\t137\n1983\t111\n1966\t87\n1979\t87\n1977\t83\n1972\t83\n1978\t82\n1973\t81\n1976\t75\n1974\t75\n1975\t74\n1971\t73\n1968\t72\n1965\t72\n1964\t72\n1970\t71\n1962\t69\n1967\t68\n1960\t66\n1969\t64\n1963\t63\n1957\t62\n1958\t62\n1959\t61\n1955\t57\n1961\t57\n1953\t55\n1956\t53\n1948\t46\n1951\t44\n1950\t44\n1954\t43\n1940\t40\n1952\t40\n1943\t40\n1947\t39\n1946\t38\n1942\t38\n1944\t37\n1939\t37\n1949\t37\n1945\t36\n1936\t32\n1937\t30\n1941\t28\n1933\t23\n1932\t22\n1938\t19\n1927\t19\n1934\t18\n1935\t18\n1931\t16\n1930\t15\n1926\t10\n1925\t10\n1928\t10\n1922\t7\n1929\t7\n1924\t6\n1923\t6\n1920\t5\n1919\t4\n1921\t3\n1918\t2\n1916\t2\n1917\t2\n1915\t1\n"}]}},{"title":"Liczba filmów według gatunku","text":"%jdbc(hive)\nuse radek;\n\nselect q.genre as genre, count(1) as counted\nfrom (select explode(split(genres,\"\\\\|\")) AS genre from movies) q\ngroup by genre\norder by counted desc;\n","user":"admin","dateUpdated":"2018-11-23T23:58:47+0000","config":{"editorSetting":{"editOnDblClick":false,"language":"sql","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"1":{"graph":{"mode":"pieChart","height":458,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"genre","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"counted","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543016588775_964608528","id":"20181011-102235_1387752112","dateCreated":"2018-11-23T23:43:08+0000","dateStarted":"2018-11-23T23:57:51+0000","dateFinished":"2018-11-23T23:57:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10291","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"genre\tcounted\nDrama\t5339\nComedy\t3703\nThriller\t1706\nRomance\t1685\nAction\t1473\nCrime\t1118\nAdventure\t1025\nHorror\t1013\nSci-Fi\t754\nFantasy\t543\nChildren\t528\nWar\t511\nMystery\t509\nDocumentary\t482\nMusical\t436\nAnimation\t286\nWestern\t275\nFilm-Noir\t148\nIMAX\t29\n(no genres listed)\t1\n"}]}},{"title":"Oceny w latach","text":"%jdbc(hive)\nuse radek;\n\nselect year(from_unixtime(cast(ts as bigint))) as years, count(*) as ile\nfrom ratings\ngroup by year(from_unixtime(cast(ts as bigint)))\norder by years\nlimit 10;\n","user":"admin","dateUpdated":"2018-11-23T23:58:47+0000","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"1":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"years","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"ile","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543016588775_-1910019359","id":"20181011-102329_1687831681","dateCreated":"2018-11-23T23:43:08+0000","dateStarted":"2018-11-23T23:57:53+0000","dateFinished":"2018-11-23T23:58:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10292","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"years\tile\n1995\t3\n1996\t1047618\n1997\t459947\n1998\t202092\n1999\t788793\n2000\t1271623\n2001\t759141\n2002\t583409\n2003\t688694\n2004\t768168\n"}]}},{"title":"Tagi w latach","text":"%jdbc(hive)\nuse radek;\n\nselect year(from_unixtime(cast(ts as bigint))) as year, count(*) as ile\nfrom tags\ngroup by year(from_unixtime(cast(ts as bigint)))\norder by year\nlimit 10;\n","user":"admin","dateUpdated":"2018-11-23T23:58:47+0000","config":{"editorSetting":{"editOnDblClick":false,"language":"sql","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"1":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"year","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"ile","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543016588775_-1890402036","id":"20181011-102536_562122210","dateCreated":"2018-11-23T23:43:08+0000","dateStarted":"2018-11-23T23:58:00+0000","dateFinished":"2018-11-23T23:58:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10293","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"year\tile\n2005\t38\n2006\t36163\n2007\t36395\n2008\t22674\n2009\t310\n"}]}},{"text":"%jdbc\n","user":"admin","dateUpdated":"2018-11-23T23:58:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543017480541_-1138131249","id":"20181123-235800_1985805148","dateCreated":"2018-11-23T23:58:00+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11908"}],"name":"Movielens","id":"2DVN2NS9Z","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}